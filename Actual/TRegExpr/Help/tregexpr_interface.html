<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<HTML xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<HEAD>
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso-8859-1">
  <meta name="Content-Language" content="english">
  <TITLE>TRegExpr interface&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Regular Expressions,perl,regexp,Delphi,Pascal,FreePascal,Kylix,Libraries,VCL,CLX,Tools,files utils</TITLE>
  <!--  TRegExpr regular expressions (r.e. RegExpr regexp tregexpr), egrep perl unix; delphi pascal FreePascal Kylix freeware component Andrey Sorokin -->
  <meta name="home_url" content="http://RegExpStudio.com/">
  <meta name="GENERATOR" content="Help & Manual">
  <LINK REL="stylesheet" HREF="../../styles/default.css" TYPE="text/css">
  <meta name="description" content=" delphi pascal FreePascal Kylix freeware components: regular expressions (r.e. RegExpr regexp tregexpr), egrep perl unix; Andrey Sorokin">
  <meta name="abstract" content=" TRegExpr regular expressions (r.e. RegExpr regexp tregexpr), egrep perl unix; Andrey Sorokin">
  <meta name="keywords" content=" TRegExpr regular expressions (r.e. RegExpr regexp tregexpr), egrep perl unix; delphi pascal FreePascal Kylix freeware component Andrey Sorokin">
  <META NAME="distribution" CONTENT="world">
  <meta name="audience" content="all">
  <meta name="robots" content="index,all">
  <meta name="revisit" content="30 days">
  <meta name="revisit-after" content="30 days">
  <meta name="site-created" content="01-01-2004">
  <META NAME="author" CONTENT="RegExpStudio.com, Andrey V. Sorokin, Saint Petersburg, Russia.">
  <META NAME="copyright" CONTENT="Copyright &copy; RegExpStudio.com, Andrey V. Sorokin, Saint Petersburg, Russia. All rights reserved">
</HEAD>
  
<BODY bgcolor=#FFFFFF leftmargin="0" topmargin="0" marginwidth="0" 
      marginheight="0">

<TABLE bgColor=#0054a6 cellspacing="2" cellpadding="2" border="0" 
       width="780">
<TR>
  <TD align="left"><div class="MainTitle"><a href="http://RegExpStudio.com"
   title="" class="MainTitle"><span class="MainTitle">RegExp Studio</span></a>
<br>TRegExpr v.0.952 - Delphi Regular Expressions
<br><img src="../../imgs/0.gif" width="1" height="15" alt=""><br>
</div></TD>
  <TD align="right"><A class=LangSwitch
   href="../../../BG/TRegExpr/Help/About.html">Bulgarian</A><BR>
  <DIV class=LangSwitch>English<BR></DIV>
  <A class=LangSwitch
   href="../../../FR/TRegExpr/Help/About.html">French</A><BR>
  <A class=LangSwitch
   href="../../../DE/TRegExpr/Help/About.html">German</A><BR>
  <A class=LangSwitch
   href="../../../RU/TRegExpr/Help/About.html">Russian</A><BR>
  <A class=LangSwitch
   href="../../../ES/TRegExpr/Help/About.html">Spanish</A></TD>
</TR>
</TABLE>

<TABLE height=1 cellSpacing=0 cellPadding=0 width=780 bgColor="white" border=0>
<TR><TD><IMG height=1 alt="" src="../../imgs/0.gif" width=1 border=0></TD></TR>
</TABLE>


<TABLE width="780" height=24 cellspacing="2" cellpadding="2" border="0"
  bgColor=#0054a6>
<TR>
  <TD><img src="../../imgs/HomeSmall.gif" alt="About TRegExpr" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="About.html">About</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/WhatsNewSmall.gif" alt="What's new" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="Whats_new.html">What's&nbsp;new</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/DownloadsSmall.gif" alt="Installation" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="Installation.html">Installation</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/RegExpSyntaxSmall.gif" alt="Regular Expressions Syntax" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="RegExp_Syntax.html">Syntax</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/TRegExprInterfaceSmall.gif" alt="What's new" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="TRegExpr_Interface.html">Interface</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/FAQSmall.gif" alt="What's new" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="FAQ.html">FAQ</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/DemosSmall.gif" alt="TRegExpr usage demos" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="Demos.html">Demos</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><IMG src="../../imgs/AnSoHomePageSmall.gif" alt="AnSo@Web" height=16 width=18 border=0></TD>
  <TD><A class=top_menu href="Author.html">Author</A></TD>

  <TD width="100%">&nbsp;</TD>
</TR>
</TABLE>



<TABLE cellSpacing=14 cellPadding=0 width=779 bgColor="white" border=0>
<TR>
  <TD vAlign=top width=769 height="100%">


<span style="font-family:Arial; font-size:12pt; color:#000000"><span style="font-family:Arial; font-size:12pt; color:#0000FF"><b>TRegExpr interface</b></span><span style="font-family:Arial; font-size:14pt; color:#000000"><span style="font-family:Arial; font-size:14pt; color:#0000FF"><b>
<br>
</b></span></span></span></span></span></span>


<span style="font-family:Arial; font-size:10pt; color:#000000"><span style="font-family:Arial; font-size:10pt; color:#0000FF"><b>Public methods and properties of TRegExpr class</b></span><span style="font-family:Arial; font-size:10pt; color:#000000">:
<br>

<br>
<b><a name="tregexpr.version"></a>class function VersionMajor</b> : integer;
<br>
<b>class function VersionMinor</b> : integer;
<br>
Return major and minor version, for example, for v. 0.944 VersionMajor = 0 and VersionMinor = 944
<br>

<br>
<b>property Expression</b> : string
<br>
Regular expression.
<br>
For optimization, TRegExpr will automatically compiles it into 'P-code' (You can see it with help of Dump method) and stores in internal structures. Real [re]compilation occures only when it really needed - while calling Exec[Next], Substitute, Dump, etc and only if Expression or other P-code affected properties was changed after last [re]compilation.
<br>
If any errors while [re]compilation occures, Error method is called (by default Error raises exception - see below)
<br>

<br>
<b>property Modifier</b><b>Str</b> : string
<br>
Set/get default values of <a href=regexp_syntax.html#about_modifiers>r.e.modifiers</a>. Format of the string is similar as in <a href=regexp_syntax.html#inline_modifiers>(?ismx-ismx)</a>. For example ModifierStr := 'i-x' will switch on modifier /i, switch off /x and leave unchanged others.
<br>
If you try to set unsupported modifier, Error will be called (by defaul Error raises exception ERegExpr).
<br>

<br>
<b><a name="tregexpr.modifier_i"></a>property ModifierI</b> : boolean
<br>
<a href=regexp_syntax.html#modifier_i>Modifier /i</a> - ("caseinsensitive"), initialized with <a href=tregexpr_interface.html#modifier_defs>RegExprModifierI</a> value.
<br>

<br>
<b><a name="tregexpr.modifier_r"></a>property ModifierR</b> : boolean
<br>
<a href=regexp_syntax.html#modifier_r>Modifier /r</a> - ("Russian.syntax extensions), initialized with <a href=tregexpr_interface.html#modifier_defs>RegExprModifierR</a> value.
<br>

<br>
<b><a name="tregexpr.modifier_s"></a>property ModifierS</b> : boolean
<br>
<a href=regexp_syntax.html#modifier_s>Modifier /s</a> - '.' works as any char (else doesn't match <a href=tregexpr_interface.html#lineseparators>LineSeparators</a> and <a href=tregexpr_interface.html#linepairedseparator>LinePairedSeparator</a>), initialized with <a href=tregexpr_interface.html#modifier_defs>RegExprModifierS</a> value.
<br>

<br>
<b><a name="tregexpr.modifier_g"></a>property ModifierG</b> : boolean;
<br>
<a href=regexp_syntax.html#modifier_g>Modifier /g</a> Switching off modifier /g switchs all operators in non-greedy style, so if ModifierG = False, then all '*' works as '*?', all '+' as '+?' and so on, initialized with <a href=tregexpr_interface.html#modifier_defs>RegExprModifierG</a> value.
<br>

<br>
<b><a name="tregexpr.modifier_m"></a>property ModifierM</b> : boolean;
<br>
<a href=regexp_syntax.html#modifier_m>Modifier /m</a> Treat string as multiple lines. That is, change `^' and `$' from matching at only the very start or end of the string to the start or end of any line anywhere within the string, initialized with <a href=tregexpr_interface.html#modifier_defs>RegExprModifierM</a> value.
<br>

<br>
<b><a name="tregexpr.modifier_x"></a>property ModifierX</b> : boolean;
<br>
<a href=regexp_syntax.html#modifier_x>Modifier /x</a> - ("eXtended syntax"), initialized with <a href=tregexpr_interface.html#modifier_defs>RegExprModifierX</a> value.
<br>

<br>
<b>function Exec</b> (const AInputString : string) : boolean;
<br>
match a programm against a string AInputString
<br>
!!! Exec store AInputString into InputString property
<br>
For Delphi 5 and higher available overloaded versions:
<br>
<b>function Exec</b> : boolean;
<br>
without parameter (uses already assigned to InputString property value)
<br>
<b>function Exec</b> (AOffset: integer) : boolean;
<br>
is same as ExecPos
<br>

<br>
<b>function ExecNext</b> : boolean;
<br>
 Find next match:
<br>
    ExecNext;
<br>
 Works same as
<br>
    if MatchLen [0] = 0 then ExecPos (MatchPos [0] + 1) 
<br>
     else ExecPos (MatchPos [0] + MatchLen [0]);
<br>
but it's more simpler !
<br>
 Raises exception if used without preceeding <b>successful</b> call to
<br>
Exec* (Exec, ExecPos, ExecNext). So You always must use something like
<br>
if Exec (InputString) then repeat { proceed results} until not ExecNext;
<br>

<br>
<b>function ExecPos</b> (AOffset: integer = 1) : boolean;
<br>
find match for InputString starting from AOffset position
<br>
(AOffset=1 - first char of InputString)
<br>

<br>
<b>property InputString</b> : string;
<br>
returns current input string (from last Exec call or last assign to this property).
<br>
Any assignment to this property clear Match* properties !
<br>

<br>
<b><a name="tregexpr.substitute"></a>function Substitute</b> (const ATemplate : string) : string;
<br>
Returns ATemplate with '$&amp;' or '$0' replaced by whole r.e. occurence and '$n' replaced by occurence of subexpression #n.
<br>
Since v.0.929 '$' used instead of '\' (for future extensions and for more Perl-compatibility) and accept more then one digit.
<br>
If you want place into template raw '$' or '\', use prefix '\'
<br>
Example: '1\$ is $2\\rub\\' -&gt; '1$ is &lt;Match[2]&gt;\rub\'
<br>
If you want to place raw digit after '$n' you must delimit n with curly braces '{}'.
<br>
Example: 'a$12bc' -&gt; 'a&lt;Match[12]&gt;bc', 'a${1}2bc' -&gt; 'a&lt;Match[1]&gt;2bc'.
<br>

<br>
<b>procedure Split</b> (AInputStr : string; APieces : TStrings);
<br>
Split AInputStr into APieces by r.e. occurencies
<br>
Internally calls Exec[Next]
<br>

<br>
<b><a name="tregexpr.replace"></a>function Replace</b> (AInputStr : RegExprString;
<br>
  const AReplaceStr : RegExprString;
<br>
  AUseSubstitution : boolean = False) : RegExprString;
<br>
<b>function Replace</b> (AInputStr : RegExprString;
<br>
  AReplaceFunc : TRegExprReplaceFunction) : RegExprString; 
<br>
<b>function ReplaceEx</b> (AInputStr : RegExprString;
<br>
  AReplaceFunc : TRegExprReplaceFunction)  : RegExprString;
<br>
 Returns AInputStr with r.e. occurencies replaced by AReplaceStr
<br>
 If AUseSubstitution is true, then AReplaceStr will be used
<br>
 as template for Substitution methods.
<br>
 For example:
<br>
  Expression := '({-i}block|var)\s*\(\s*([^ ]*)\s*\)\s*';
<br>
  Replace ('BLOCK( test1)', 'def "$1" value "$2"', True);
<br>
   will return:  def 'BLOCK' value 'test1'
<br>
  Replace ('BLOCK( test1)', 'def "$1" value "$2"', False)
<br>
   will return:  def "$1" value "$2"
<br>
 Internally calls Exec[Next]
<br>
Overloaded version and ReplaceEx operate with call-back function,
<br>
so You can implement really complex functionality.
<br>

<br>
<b><a name="subexprmatchcount"></a>property</b><b> SubExprMatchCount</b> : integer; // ReadOnly
<br>
Number of subexpressions has been found in last Exec* call.
<br>
If there are no subexpr. but whole expr was found (Exec* returned True), then SubExprMatchCount=0, if no subexpressions nor whole r.e. found (Exec* returned false) then SubExprMatchCount=-1.
<br>
Note, that some subexpr. may be not found and for such subexpr. MathPos=MatchLen=-1 and Match=''.
<br>
For example: Expression := '(1)?2(3)?';
<br>
 Exec ('123'): SubExprMatchCount=2, Match[0]='123', [1]='1', [2]='3'
<br>
 Exec ('12'): SubExprMatchCount=1, Match[0]='12', [1]='1'
<br>
 Exec ('23'): SubExprMatchCount=2, Match[0]='23', [1]='', [2]='3'
<br>
 Exec ('2'): SubExprMatchCount=0, Match[0]='2'
<br>
 Exec ('7') - return False: SubExprMatchCount=-1
<br>

<br>
<b>property MatchPos</b> [Idx : integer] : integer; // ReadOnly
<br>
pos of entrance subexpr. #Idx into tested in last Exec* string. First subexpr. have Idx=1, last - MatchCount, whole r.e. have Idx=0.
<br>
Returns -1 if in r.e. no such subexpr. or this subexpr. not found in input string.
<br>

<br>
<b>property MatchLen</b> [Idx : integer] : integer; // ReadOnly
<br>
len of entrance subexpr. #Idx r.e. into tested in last Exec* string. First subexpr. have Idx=1, last - MatchCount, whole r.e. have Idx=0.
<br>
Returns -1 if in r.e. no such subexpr. or this subexpr. not found in input string.
<br>

<br>
<b><a name="tregexpr.match"></a>property</b><b> Match</b> [Idx : integer] : string; // ReadOnly
<br>
== copy (InputString, MatchPos [Idx], MatchLen [Idx])
<br>
Returns '' if in r.e. no such subexpr. or this subexpr. not found in input string.
<br>

<br>
<b>function LastError</b> : integer;
<br>
Returns ID of last error, 0 if no errors (unusable if Error method raises exception) and clear internal status into 0 (no errors).
<br>

<br>
<b>function ErrorMsg</b> (AErrorID : integer) : string; virtual;
<br>
Returns Error message for error with ID = AErrorID.
<br>

<br>
<b>property CompilerErrorPos</b> : integer; // ReadOnly
<br>
Returns pos in r.e. there compiler stopped.
<br>
Usefull for error diagnostics
<br>

<br>
<b>property </b><span style="font-family:Arial; font-size:10pt; color:#7F0000"><b><a name="tregexpr.spacechars"></a>SpaceChars</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000"> : RegExprString
<br>
Contains chars, treated as \s (initially filled with RegExprSpaceChars global constant)
<br>

<br>
<b>property </b><span style="font-family:Arial; font-size:10pt; color:#7F0000"><b><a name="tregexpr.wordchars"></a>WordChars</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000"> : RegExprString;
<br>
Contains chars, treated as \w (initially filled with RegExprWordChars global constant)
<br>

<br>
<b>property </b><span style="font-family:Arial; font-size:10pt; color:#7F0000"><b><a name="lineseparators"></a>LineSeparators</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000"> : RegExprString
<br>
line separators (like \n in Unix), initially filled with RegExprLineSeparators global constant)
<br>
see also <a href=regexp_syntax.html#syntax_line_separators>about line separators</a>
<br>

<br>
<b>property </b><span style="font-family:Arial; font-size:10pt; color:#7F0000"><b><a name="linepairedseparator"></a>LinePairedSeparator</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000"> : RegExprString
<br>
paired line separator (like \r\n in DOS and Windows).
<br>
must contain exactly two chars or no chars at all, initially filled with RegExprLinePairedSeparator global constant)
<br>
see also <a href=regexp_syntax.html#syntax_line_separators>about line separators</a>
<br>

<br>
For example, if You need Unix-style behaviour, assign LineSeparators := #$a (newline character) and LinePairedSeparator := '' (empty string), if You want to accept as line separators only \x0D\x0A but not \x0D or \x0A alone, then assign LineSeparators := '' (empty string) and LinePairedSeparator := #$d#$a.
<br>

<br>
By default 'mixed' mode is used (defined in RegExprLine[Paired]Separator[s] global constants): LineSeparators := #$d#$a; LinePairedSeparator := #$d#$a. Behaviour of this mode is detailed described in the <a href=regexp_syntax.html#syntax_line_separators>syntax section</a>.
<br>

<br>
<b>class function InvertCaseFunction</b>  (const Ch : REChar) : REChar;
<br>
Converts Ch into upper case if it in lower case or in lower if it in upper (uses current system local setings)
<br>

<br>
<b><a name="invertcase"></a>property InvertCase</b> : TRegExprInvertCaseFunction;
<br>
Set this property if you want to override case-insensitive functionality.
<br>
Create set it to RegExprInvertCaseFunction (InvertCaseFunction by default)
<br>

<br>
<b>procedure Compile</b>;
<br>
[Re]compile r.e. Usefull for example for GUI r.e. editors (to check all properties validity).
<br>

<br>
<b>function Dump</b> : string;
<br>
dump a compiled regexp in vaguely comprehensible form
<br>

<br>

<br>
<span style="font-family:Arial; font-size:10pt; color:#0000FF"><b>Global constants
<br>
</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>
<b> </b><b><a name="escchar"></a>EscChar</b> = '\';  // 'Escape'-char ('\' in common r.e.) used for escaping metachars (\w, \d etc).
<br>
  // it's may be usefull to redefine it if You are using C++ Builder - to avoide ugly constructions
<br>
  // like '\\w+\\\\\\w+\\.\\w+' - just define EscChar='/' and use '/w+\/w+/./w+'
<br>

<br>
<a name="modifier_defs"></a>Modifiers default values:
<br>
  <b>RegExprModifierI</b><span style="font-family:Arial; font-size:10pt; color:#7F0000"><b> </b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000">: boolean = False;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_i>TRegExpr.ModifierI</a>
<br>
  <b>RegExprModifierR</b> : boolean = True;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_r>TRegExpr.ModifierR</a>
<br>
  <b>RegExprModifierS</b> : boolean = True;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_s>TRegExpr.ModifierS</a>
<br>
  <b>RegExprModifierG</b> : boolean = True;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_g>TRegExpr.ModifierG</a>
<br>
  <b>RegExprModifierM</b> : boolean = False;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_m>TRegExpr.ModifierM</a>
<br>
  <b>RegExprModifierX</b> : boolean = False;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_x>TRegExpr.ModifierX</a>
<br>

<br>
  <b>RegExprSpaceChars</b> : RegExprString = ' '#$9#$A#$D#$C;
<br>
  // default for SpaceChars property
<br>

<br>
  <b>RegExprWordChars</b> : RegExprString =
<br>
    '0123456789'
<br>
  + 'abcdefghijklmnopqrstuvwxyz'
<br>
  + 'ABCDEFGHIJKLMNOPQRSTUVWXYZ_';
<br>
  // default value for WordChars property
<br>

<br>
  <b>RegExprLineSeparators</b> : RegExprString =
<br>
   #$d#$a{$IFDEF UniCode}#$b#$c#$2028#$2029#$85{$ENDIF};
<br>
  // default value for LineSeparators property
<br>
  <b>RegExprLinePairedSeparator</b> : RegExprString =
<br>
   #$d#$a;
<br>
  // default value for LinePairedSeparator property
<br>

<br>
  <b>RegExpr</b><b>Invert</b><b>CaseFunction</b> : TRegExprInvertCaseFunction = TRegExpr.InvertCaseFunction; 
<br>
  // default for InvertCase property
<br>

<br>

<br>
<span style="font-family:Arial; font-size:10pt; color:#0000FF"><b>Usefull global functions</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>

<br>
<b>function ExecRegExpr</b> (const ARegExpr, AInputStr : string) : boolean;
<br>
true if string AInputString match regular expression ARegExpr
<br>
! will raise exeption if syntax errors in ARegExpr
<br>

<br>
<b>procedure SplitRegExpr</b> (const ARegExpr, AInputStr : string; APieces : TStrings);
<br>
Split AInputStr into APieces by r.e. ARegExpr occurencies
<br>

<br>
<b>function ReplaceRegExpr</b> (const ARegExpr, AInputStr, AReplaceStr : string;
<br>
 AUseSubstitution : boolean = False) : string;
<br>
Returns AInputStr with r.e. occurencies replaced by AReplaceStr.
<br>
If AUseSubstitution is true, then AReplaceStr will be used as template for Substitution methods.
<br>
For example:
<br>
 ReplaceRegExpr ('({-i}block|var)\s*\(\s*([^ ]*)\s*\)\s*',
<br>
  'BLOCK( test1)', 'def "$1" value "$2"', True)
<br>
 will return:  def 'BLOCK' value 'test1'
<br>
 ReplaceRegExpr ('({-i}block|var)\s*\(\s*([^ ]*)\s*\)\s*',
<br>
  'BLOCK( test1)', 'def "$1" value "$2"')
<br>
  will return:  def "$1" value "$2"
<br>

<br>
<b>function Quot</b><b>e</b><b>RegExprMetaChars</b> (const AStr : string) : string;
<br>
Replace all metachars with its safe representation, for example 'abc$cd.(' converts into 'abc\$cd\.\('
<br>
This function usefull for r.e. autogeneration from user input
<br>

<br>
<b>function RegExprSubExpressions</b> (const ARegExpr : string;
<br>
 ASubExprs : TStrings; AExtendedSyntax : boolean = False) : integer;
<br>
Makes list of subexpressions found in ARegExpr r.e.
<br>
In ASubExps every item represent subexpression, from first to last, in format:
<br>
  String - subexpression text (without '()')
<br>
  low word of Object - starting position in ARegExpr, including '(' if exists! (first position is 1)
<br>
  high word of Object - length, including starting '(' and ending ')' if exist!
<br>
AExtendedSyntax - must be True if modifier /x will be On while using the r.e.
<br>
Usefull for GUI editors of r.e. etc (You can find example of using in <a href=regexpstudio.html>TestRExp.dpr</a> project)
<br>

<br>
<b>Result code</b>&nbsp;&nbsp;&nbsp;<b>Meaning</b>
<br>
</span><span style="font-family:Arial; font-size:1pt; color:#000000"><hr></span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>
<b>0</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Success. No unbalanced brackets was found;
<br>
<b>-1</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;there are not enough closing brackets ')';
<br>
<b>-(n+1)</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at position <b>n</b> was found opening '[' without corresponding closing ']';
<br>
<b>n</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;at position <b>n</b> was found closing bracket ')' without corresponding opening '('.
<br>

<br>
If Result &lt;&gt; 0, then ASubExprs can contain empty items or illegal ones
<br>

<br>

<br>
<span style="font-family:Arial; font-size:10pt; color:#0000FF"><b>Exception type</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>

<br>
Default error handler of TRegExpr raise exception:
<br>

<br>
<b>ERegExpr </b>= class (Exception)
<br>
   public
<br>
    ErrorCode : integer; // error code. Compilation error codes are before 1000.
<br>
    CompilerErrorPos : integer; // Position in r.e. where compilation error occured
<br>
  end;
<br>

<br>

<br>
<span style="font-family:Arial; font-size:10pt; color:#0000FF"><b><a name="unicode_support"></a>How to use Unicode</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>

<br>
TRegExpr now supports UniCode, but it works <b>very slow</b> :(
<br>
Who want to optimize it ? ;)
<br>
Use it only if you really need Unicode support !
<br>
Remove '.' in {.$DEFINE UniCode} in regexpr.pas. After that all strings will be treated as WideString.
<br>

<br>
</span></span></span>

  </TD>
  <TD vAlign=top align=left bgColor="white" height="100%"
       width=10>
  </TD>
</TR>
</TABLE><BR><BR>

<TABLE height=1 cellSpacing=0 cellPadding=0 width=780 bgColor=#0054a6 
       border=0>
<TR>
  <TD><IMG height=1 alt="" src="../../imgs/0.gif" width=1 border=0></TD>
</TR>
</TABLE>

<TABLE height=70 cellSpacing=2 cellPadding=0 width=779 bgColor="white"
       border=0>
<TR>
  <TD align=right width=2><IMG src="../../imgs/0.gif" width=2 height=1 border=0></TD>
  <TD vAlign=top align=left width="100%"><P class=pageauthor><I>&copy;&nbsp;<A 
      class=pageauthor href="http://RegExpStudio.com/">2004 Andrey V. Sorokin</A></I>,
      Saint Petersburg, Russia
      <BR><A class=pageauthor href="mailto:anso@mail.ru">anso@mail.ru</A>
      <BR><A class=pageauthor href="http://RegExpStudio.com/">RegExpStudio.com</A></P></TD>
  <TD vAlign=top align=right width=468><A href="http://www.helpandmanual.com"
      target="_blank"><img src="hmad468x60.gif"" width="468" height="60"
      border="0" alt="Help&Manual - the best help authoring tool!"></A></TD>
  <TD align=right width=4><IMG src="../imgs/0.gif" width=4 height=1 border=0></TD>
</TR>
</TABLE><BR>

</body>
</html>
