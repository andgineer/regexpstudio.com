<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<HTML xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<HEAD>
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=Windows-1251">
  <meta name="Content-Language" content="russian">
  <TITLE>Интерфейс&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;регулярные выражения,perl,regexp,Delphi,Pascal,FreePascal,Kylix,Libraries,VCL,CLX,Tools,files utils</TITLE>
  <!--  TRegExpr регулярные выражения (r.e. RegExpr regexp tregexpr), egrep perl unix; delphi pascal FreePascal Kylix freeware component Andrey Sorokin -->
  <meta name="home_url" content="http://RegExpStudio.com/">
  <meta name="GENERATOR" content="Help & Manual">
  <LINK REL="stylesheet" HREF="../../../styles/default.css" TYPE="text/css">
  <meta name="description" content=" delphi pascal FreePascal Kylix freeware components: regular expressions (r.e. RegExpr regexp tregexpr), egrep perl unix; Андрей Сорокин">
  <meta name="abstract" content=" TRegExpr регулярные выражения (r.e. RegExpr regexp tregexpr), egrep perl unix; Андрей Сорокин">
  <meta name="keywords" content=" TRegExpr регулярные выражения (r.e. RegExpr regexp tregexpr), egrep perl unix; delphi pascal FreePascal Kylix freeware component Андрей Сорокин">
  <META NAME="distribution" CONTENT="world">
  <meta name="audience" content="all">
  <meta name="robots" content="index,all">
  <meta name="revisit" content="30 days">
  <meta name="revisit-after" content="30 days">
  <meta name="site-created" content="01-01-2004">
  <META NAME="author" CONTENT="RegExpStudio.com, Andrey V. Sorokin, Saint Petersburg, Russia.">
  <META NAME="copyright" CONTENT="Copyright &copy; RegExpStudio.com, Andrey V. Sorokin, Saint Petersburg, Russia. All rights reserved">
</HEAD>
  
<BODY bgcolor=#FFFFFF leftmargin="0" topmargin="0" marginwidth="0" 
      marginheight="0">

<TABLE bgColor=#0054a6 cellspacing="2" cellpadding="2" border="0" 
       width="780">
<TR>
  <TD align="left"><div class="MainTitle"><a href="http://RegExpStudio.com"
   title="" class="MainTitle"><span class="MainTitle">RegExp Studio</span></a>
<br>TRegExpr v.0.952 - Регулярные выражения для Delphi
<br><img src="../../../imgs/0.gif" width="1" height="15" alt=""><br>
</div></TD>
  <TD align="right"><A class=LangSwitch
   href="../../../BG/TRegExpr/Help/About.html">Болгарский</A><BR>
  <A class=LangSwitch
   href="../../../RU/TRegExpr/Help/About.html">Английский</A><BR>
  <A class=LangSwitch
   href="../../../FR/TRegExpr/Help/About.html">Французский</A><BR>
  <A class=LangSwitch
   href="../../../DE/TRegExpr/Help/About.html">Немецкий</A><BR>
  <DIV class=LangSwitch>Русский<BR></DIV>
  <A class=LangSwitch
   href="../../../ES/TRegExpr/Help/About.html">Испанский</A></TD>
</TR>
</TABLE>

<TABLE height=1 cellSpacing=0 cellPadding=0 width=780 bgColor="white" border=0>
<TR><TD><IMG height=1 alt="" src="../../../imgs/0.gif" width=1 border=0></TD></TR>
</TABLE>


<TABLE width="780" height=24 cellspacing="2" cellpadding="2" border="0"
  bgColor=#0054a6>
<TR>
  <TD><img src="../../../imgs/HomeSmall.gif" alt="About TRegExpr" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="About.html">Введение</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../../imgs/DownloadsSmall.gif" alt="Installation" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="Installation.html">Установка</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../../imgs/RegExpSyntaxSmall.gif" alt="Regular Expressions Syntax" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="RegExp_Syntax.html">Синтаксис</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../../imgs/TRegExprInterfaceSmall.gif" alt="TRegExpr Interface" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="TRegExpr_Interface.html">Интерфейс</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../../imgs/FAQSmall.gif" alt="FAQ" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="FAQ.html">ЧАВО</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../../imgs/DemosSmall.gif" alt="TRegExpr usage demos" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="Demos.html">Демо</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../../imgs/0.gif" width=5 border=0></TD>
  <TD><IMG src="../../../imgs/AnSoHomePageSmall.gif" alt="AnSo@Web" height=16 width=18 border=0></TD>
  <TD><A class=top_menu href="Author.html">Автор</A></TD>

  <TD width="100%">&nbsp;</TD>
</TR>
</TABLE>



<TABLE cellSpacing=14 cellPadding=0 width=779 bgColor="white" border=0>
<TR>
  <TD vAlign=top width=769 height="100%">


<span style="font-family:Arial; font-size:12pt; color:#000000"><span style="font-family:Arial; font-size:12pt; color:#0000FF"><b>Интерфейс</b></span><span style="font-family:Arial; font-size:14pt; color:#000000"><span style="font-family:Arial; font-size:14pt; color:#0000FF"><b>
<br>
</b></span></span></span></span></span></span>


<span style="font-family:Arial; font-size:10pt; color:#000000"><span style="font-family:Arial; font-size:10pt; color:#0000FF"><b>Методы и свойства</b></span><span style="font-family:Arial; font-size:10pt; color:#000000"><span style="font-family:Arial; font-size:10pt; color:#0000FF"><b> TRegExpr</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000">:
<br>

<br>
<b><a name="tregexpr.version"></a>class function VersionMajor</b> : integer;
<br>
<b>class function VersionMinor</b> : integer;
<br>
Возвращают соответственно старшую и младшую часть версии, например, для v. 0.950 VersionMajor = 0 и VersionMinor = 950
<br>

<br>
<b>property Expression</b> : string;
<br>
Собственно регулярное выражение.
<br>
Для ускорения работы TRegExpr автоматически выполняет компиляцию выражения во внутреннее представления (его можно посмотреть через Dump).
<br>
Однако, делается это только тогда, когда это реально необходимо, т.е. при обращении к методам Exec[Next], Substitute, Dump и т.п. и только в том случае, если после последней [пере]компиляции было изменено свойство Expression или какие-либо другие влияющие на откомпилированное выражение свойства.
<br>
При ошибках компиляции вызывается метод Error (по умолчанию он генерирует исключение ERegExpr - см. ниже)
<br>

<br>
<b>property Modifier</b><b>Str</b> : string;
<br>
Проверка и установка <a href=regexp_syntax.html#about_modifiers>модификаторов</a> с помощью строки в том же формате, что и в конструкции <a href=regexp_syntax.html#inline_modifiers>(?ismx-ismx)</a>. Т.е., например ModifierStr := 'i-x' включит регистро-независимый режим и выключит режим расширенного синтаксиса, прочие модификаторы останутся без изменений. 
<br>
Если указать несуществующий модификатор, вызывается Error
<br>

<br>
<b><a name="tregexpr.modifier_i"></a>property ModifierI</b> : boolean;
<br>
<a href=regexp_syntax.html#modifier_i>Модификатор /i</a> - ("регистро-независимый режим"), инициализируется из <a href=tregexpr_interface.html#modifier_defs>RegExprModifierI</a>
<br>

<br>
<b><a name="tregexpr.modifier_r"></a>property ModifierR</b> : boolean;
<br>
<a href=regexp_syntax.html#modifier_r>Модификатор /r</a> ("русские диапазоны"), инициализируется из <a href=tregexpr_interface.html#modifier_defs>RegExprModifierR</a>
<br>

<br>
<b><a name="tregexpr.modifier_s"></a>property ModifierS</b> : boolean
<br>
<a href=regexp_syntax.html#modifier_s>Модификатор /s</a> - если установлен, то '.' совпадает с любым символом, (если сброшен, то '.' не совпадает с <a href=tregexpr_interface.html#lineseparators>LineSeparators</a> и <a href=tregexpr_interface.html#linepairedseparator>LinePairedSeparator</a>, , инициализируется из <a href=tregexpr_interface.html#modifier_defs>RegExprModifierS</a>
<br>

<br>
<b><a name="tregexpr.modifier_g"></a>property ModifierG</b> : boolean;
<br>
<a href=regexp_syntax.html#modifier_g>Модификатор /g</a>, отключение приводит к тому, что все операторы работают в "не жадном" (non-greedy) режиме, т.е. когда ModifierG = False, то все '*' работают как '*?', все '+' как '+?' и т.д.., инициализируется из <a href=tregexpr_interface.html#modifier_defs>RegExprModifierG</a>
<br>

<br>
<b><a name="tregexpr.modifier_m"></a>property ModifierM</b> : boolean;
<br>
<a href=regexp_syntax.html#modifier_m>Модификатор /m</a> -воспринимать входной текст как многострочный. Если выключен, то метасимволы `^' и `$' "срабатывают" только в начале и конце входного текста.
<br>
Если включен, то эти символы срабатывают также и в начале и в конце каждой строки входного текста., инициализируется из <a href=tregexpr_interface.html#modifier_defs>RegExprModifierM</a>
<br>

<br>
<b><a name="tregexpr.modifier_x"></a>property ModifierX</b> : boolean;
<br>
<a href=regexp_syntax.html#modifier_x>Модификатор /x</a> - ("расширенный синтаксис"), инициализируется из <a href=tregexpr_interface.html#modifier_defs>RegExprModifierX</a>
<br>

<br>
<b>function Exec</b> (const AInputString : string) : boolean;
<br>
Выполнить выражение применительно к входной строке AInputString
<br>
!!! также, запоминает AInputString в ствойстве InputString
<br>
For Delphi 5 and higher available overloaded versions:
<br>
<b>function Exec</b> : boolean;
<br>
without parameter (uses already assigned to InputString property value)
<br>
<b>function Exec</b> (AOffset: integer) : boolean;
<br>
is same as ExecPos
<br>

<br>
<b>function ExecNext</b> : boolean;
<br>
поиск следующего совпадения. Фактически:
<br>
    Exec (AString);
<br>
 означает то же что и
<br>
   if MatchLen [0] = 0 then ExecPos (MatchPos [0] + 1) 
<br>
     else ExecPos (MatchPos [0] + MatchLen [0]);
<br>
 но воспринимается гораздо нагляднее!
<br>
Выдает исключение если этому вызову не предшествовал <b>успешный</b> вызов метода
<br>
Exec* (Exec, ExecPos, ExecNext). Т.е. необходимо использовать что-то вида
<br>
 if Exec (InputString) then repeat { обработка} until not ExecNext;
<br>

<br>
<b>function ExecPos</b> (AOffset: integer = 1) : boolean;
<br>
выполняет выражение для строки в InputString начиная с позиции AOffset
<br>
(AOffset=1 - первый символ InputString)
<br>

<br>
<b>property InputString</b> : string;
<br>
текущая входная строка (присвоенная явно или в последнем Exec).
<br>
Присвоение этому свойству значений делает неопределенными свойства Match* !
<br>

<br>
<b><a name="tregexpr.substitute"></a>function Substitute</b> (const ATemplate : string) : string;
<br>
Возвращает ATemplate в котором все '$&amp;' и '$0' заменены на найденное регулярное выражение, а '$n' заменены на подвыражения #n.
<br>
Начиная с версии v.0.929 используется '$' вместо '\' (для расширений типа \n\r и т.п. а также для большей схожести с Perl) и допускаются n &gt; 9.
<br>
Если Вам необходим просто символ '$' или '\', предваряйте их '\'.
<br>
Например: '1\$ is $2\\rub\\' -&gt; '1$ is &lt;Match[2]&gt;\rub\'
<br>
Если Вам необходимо сразу после '$n' поместить цифру, заключайте n в фигурные скобки '{}'.
<br>
Например: 'a$12bc' -&gt; 'a&lt;Match[12]&gt;bc', 'a${1}2bc' -&gt; 'a&lt;Match[1]&gt;2bc'.
<br>

<br>
<b>procedure Split</b> (AInputStr : string; APieces : TStrings);
<br>
Режет входную строку AInputStr на помещаемые в APieces куски разделяемые вхождениями выражения. Внимание! Этот метод вызывает методы Exec[Next]
<br>

<br>
<b><a name="tregexpr.replace"></a>function Replace</b> (AInputStr : RegExprString;
<br>
  const AReplaceStr : RegExprString;
<br>
  AUseSubstitution : boolean = False) : RegExprString;
<br>
<b>function Replace</b> (AInputStr : RegExprString;
<br>
  AReplaceFunc : TRegExprReplaceFunction) : RegExprString; 
<br>
<b>function ReplaceEx</b> (AInputStr : RegExprString;
<br>
  AReplaceFunc : TRegExprReplaceFunction)  : RegExprString;
<br>
Заменяет в AInputStr все вхождения выражения на AReplaceStr
<br>
Если AUseSubstitution = true, то AReplaceStr будет восприниматься как шаблон для метода Substitution.
<br>
 Например:
<br>
  Expression := '({-i}block|var)\s*\(\s*([^ ]*)\s*\)\s*';
<br>
  Replace ('BLOCK( test1)', 'def "$1" value "$2"', True);
<br>
   вернет:  def 'BLOCK' value 'test1'
<br>
  Replace ('BLOCK( test1)', 'def "$1" value "$2"', False)
<br>
   вернет:  def "$1" value "$2"
<br>
Внимание! Этот метод вызывает методы Exec[Next]
<br>
Вариант с параметром-функцией и ReplaceEx отличаются тем, что передается не строка, а ссылка на функцию, которая в динамике формирует строку для замены, что позволяет реализовать сложные варианты замен.
<br>

<br>

<br>

<br>
<b><a name="subexprmatchcount"></a>property</b><b> SubExprMatchCount</b> : integer; // ReadOnly
<br>
Число подвыражений, найденных в последнем Exec*. если найдено только само выражение в целом, то SubExprMatchCount=0, если и само выражение не найдено (Exec* вернул false) то SubExprMatchCount=-1. Обратите внимание, что часть подвыражений может быть не найдено и для них MathPos=MatchLen=-1 и Match=''.
<br>
Например, для Expression := '(1)?2(3)?';
<br>
Exec ('123'): SubExprMatchCount=2, Match[0]='123', [1]='1', [2]='3'
<br>
Exec ('12'): SubExprMatchCount=1, Match[0]='12', [1]='1'
<br>
Exec ('23'): SubExprMatchCount=2, Match[0]='23', [1]='', [2]='3'
<br>
Exec ('2'): SubExprMatchCount=0, Match[0]='2'
<br>
Exec ('7') - возвращает False: SubExprMatchCount=-1
<br>

<br>
<b>property MatchPos</b> [Idx : integer] : integer; // ReadOnly
<br>
Позиция начала подвыражения #Idx во входной строке
<br>
Первое подвыражение имеет Idx=1, последнее - MatchCount, выражение в целом  Idx=0.
<br>
Возвращает -1 если нет такого подвыражения или если оно не найдено во входной строке.
<br>

<br>
<b>property MatchLen</b> [Idx : integer] : integer; // ReadOnly
<br>
Длина подвыражения #Idx во входной строке
<br>
Первое подвыражение имеет Idx=1, последнее - MatchCount, выражение в целом  Idx=0.
<br>
Возвращает -1 если нет такого подвыражения или если оно не найдено во входной строке.
<br>

<br>
<b><a name="tregexpr.match"></a>property</b><b> Match</b> [Idx : integer] : string; // ReadOnly
<br>
== copy (InputString, MatchPos [Idx], MatchLen [Idx])
<br>
Возвращает '' если нет такого подвыражения или если оно не найдено во входной строке.
<br>

<br>
<b>function LastError</b> : integer;
<br>
Код последней ошибки, 0 если нет ошибки (бессмысленно использовать эту функцию, если Вы не изменяете реализацию Error, поскольку текущая реализация генерирует исключительную ситуацию).
<br>
Вызов этой функции очищает внутреннюю переменную и повторный вызов всегда вернет 0.
<br>

<br>
<b>function ErrorMsg</b> (AErrorID : integer) : string; virtual;
<br>
Возвращает текст сообщения об ошибке с кодом AErrorID.
<br>

<br>
<b>property CompilerErrorPos</b> : integer; // ReadOnly
<br>
Возвращает позицию, в которой случилась последняя ошибка компиляции (упрощает отладку выражений)
<br>

<br>
<b>property </b><span style="font-family:Arial; font-size:10pt; color:#7F0000"><b><a name="tregexpr.spacechars"></a>SpaceChars</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000"> : RegExprString
<br>
Содержит символы, трактуемые как \s (инициализируется из глобальной константы RegExprSpaceChars)
<br>

<br>
<b>property </b><span style="font-family:Arial; font-size:10pt; color:#7F0000"><b><a name="tregexpr.wordchars"></a>WordChars</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000"> : RegExprString;
<br>
Содержит символы, трактуемые как \w (инициализируется из глобальной константы RegExprWordChars)
<br>

<br>
<b>property </b><span style="font-family:Arial; font-size:10pt; color:#7F0000"><b><a name="lineseparators"></a>LineSeparators</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000"> : RegExprString
<br>
Разделители строк (например, \n для Unix) (инициализируется из глобальной константы RegExprLineSeparators)
<br>
<a href=regexp_syntax.html#syntax_line_separators>см.подробнее о разделителях строк</a>
<br>

<br>
<b>property </b><span style="font-family:Arial; font-size:10pt; color:#7F0000"><b><a name="linepairedseparator"></a>LinePairedSeparator</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000"> : RegExprString
<br>
Сдвоенный разделитель строк (как, \r\n для DOS и Windows) (инициализируется из глобальной константы RegExprLinePairedSeparator)
<br>
<a href=regexp_syntax.html#syntax_line_separators>см.подробнее о разделителях строк</a>
<br>

<br>
Например, если Вам необходимо отслеживать только Unix-разделители строк, присвойте LineSeparators := #$a (символ новой строки) и LinePairedSeparator := '' (пустую строку), если необходимо воспринимать как разделители строк только \x0D\x0A но не отдельные \x0D или \x0A, присвойте LineSeparators := '' (пустую строку) и LinePairedSeparator := #$d#$a.
<br>

<br>
По умолчанию используется "смешанный вариант" (им инициализированы константы RegExprLine[Paired]Separator[s]): LineSeparators := #$d#$a; LinePairedSeparator := #$d#$a подробно описанный в <a href=regexp_syntax.html#syntax_line_separators>описании синтаксиса</a>.
<br>

<br>
<b>class function InvertCaseFunction</b>  (const Ch : REChar) : REChar;
<br>
Преобразует символ Ch в верхний регистр если это символ нижнего регистра и в нижний - если верхнего (используются текущие установки операционной системы)
<br>

<br>
<b><a name="invertcase"></a>property InvertCase</b> : TRegExprInvertCaseFunction;
<br>
Позволяет определить свою собственную реализацию <a href=regexp_syntax.html#modifier_i>регистро-независимого</a> режима работы TRegExpr. Инициализируется из глобальной константы RegExprInvertCaseFunction (по умолчанию она указывает на InvertCaseFunction)
<br>

<br>
<b>procedure Compile</b>;
<br>
Вызывает принудительную [пере]компиляцию  регулярного выражения.
<br>
Может быть полезной, например, для проверки корректности всех свойств при создании визуальных редакторов рег.выражений и т.п.
<br>

<br>
<b>function Dump</b> : string;
<br>
возвращает внутренний формат в который было откомпилировано выражение. Предназначено для особо любознательных ;)
<br>

<br>

<br>
<span style="font-family:Arial; font-size:10pt; color:#0000FF"><b>Глобальные константы</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000"><span style="font-family:Arial; font-size:10pt; color:#0000FF"><b>
<br>
</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>
<b> EscChar</b> = '\';  // 'Escape'-char ('\' in common r.e.) used for escaping metachars (\w, \d etc).
<br>
  // it's may be usefull to redefine it if You are using C++ Builder - to avoide ugly constructions
<br>
  // like '\\w+\\\\\\w+\\.\\w+' - just define EscChar='/' and use '/w+\/w+/./w+'
<br>

<br>
<a name="modifier_defs"></a>Значения по умолчанию для модификаторов:
<br>
  <b>RegExprModifierI</b><span style="font-family:Arial; font-size:10pt; color:#7F0000"><b> </b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000">: boolean = False;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_i>TRegExpr.ModifierI</a>
<br>
  <b>RegExprModifierR</b> : boolean = True;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_r>TRegExpr.ModifierR</a>
<br>
  <b>RegExprModifierS</b> : boolean = True;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_s>TRegExpr.ModifierS</a>
<br>
  <b>RegExprModifierG</b> : boolean = True;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_g>TRegExpr.ModifierG</a>
<br>
  <b>RegExprModifierM</b> : boolean = False;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_m>TRegExpr.ModifierM</a>
<br>
  <b>RegExprModifierX</b> : boolean = False;&nbsp;&nbsp;&nbsp;// <a href=tregexpr_interface.html#tregexpr.modifier_x>TRegExpr.ModifierX</a>
<br>

<br>
  <b>RegExprSpaceChars</b> : RegExprString // Значение по умолчанию для SpaceChars
<br>
    = ' '#$9#$A#$D#$C;
<br>

<br>
  <b>RegExprWordChars</b> : RegExprString // Значение по умолчанию для WordChars
<br>
   =  '0123456789'
<br>
  + 'abcdefghijklmnopqrstuvwxyz'
<br>
  + 'ABCDEFGHIJKLMNOPQRSTUVWXYZ_';
<br>

<br>
  <b>RegExprLineSeparators</b> : RegExprString // Значение по умолчанию для LineSeparators
<br>
   =  #$d#$a{$IFDEF UniCode}#$b#$c#$2028#$2029#$85{$ENDIF};
<br>
  <b>RegExprLinePairedSeparator</b> : RegExprString // Значение по умолчанию для LinePairedSeparator
<br>
   = #$d#$a;
<br>

<br>
  <b>RegExpr</b><b>Invert</b><b>CaseFunction</b> : TRegExprInvertCaseFunction // Значение по умолчанию для InvertCase
<br>
 = TRegExpr.InvertCaseFunction; 
<br>

<br>

<br>
<span style="font-family:Arial; font-size:10pt; color:#0000FF"><b>Глобальные функции</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>

<br>
<b>function ExecRegExpr</b> (const ARegExpr, AInputStr : string) : boolean;
<br>
true если строка AInputString совпадает с выражением ARegExpr
<br>
! При ошибках в ARegExpr будет генерировать exception
<br>

<br>
<b>procedure SplitRegExpr</b> (const ARegExpr, AInputStr : string; APieces : TStrings);
<br>
Режет AInputStr на помещаемые в APieces куски по вхождениям выражения ARegExpr (например, разбиение строки на отдельные поля, разделенные некой последовательностью символов)
<br>

<br>
<b>function ReplaceRegExpr</b> (const ARegExpr, AInputStr, AReplaceStr : string;
<br>
 AUseSubstitution : boolean = False) : string;
<br>
Возвращает AInputStr в которой все вхождения выражения ARegExpr заменены на AReplaceStr. Если AUseSubstitution = true, то AReplaceStr будет восприниматься как шаблон для Substitution:
<br>
 ReplaceRegExpr ('({-i}block|var)\s*\(\s*([^ ]*)\s*\)\s*',
<br>
  'BLOCK( test1)', 'def "$1" value "$2"', True)
<br>
 возвращает:  def 'BLOCK' value 'test1'
<br>
 ReplaceRegExpr ('({-i}block|var)\s*\(\s*([^ ]*)\s*\)\s*',
<br>
  'BLOCK( test1)', 'def "$1" value "$2"')
<br>
 возвращает:  def "$1" value "$2"
<br>

<br>
<b>function Quot</b><b>e</b><b>RegExprMetaChars</b> (const AStr : string) : string;
<br>
Заменяет все метасимволы во входной строке так, чтобы ее можно было безопасно использовать внутри регулярного выражения. 
<br>
Например 'abc$cd.(' преобразуется в 'abc\$cd\.\('
<br>
Эта функция полезна для автоматического синтеза регулярного выражения на основании пользовательских данных
<br>

<br>
<b>function RegExprSubExpressions</b> (const ARegExpr : string;
<br>
 ASubExprs : TStrings; AExtendedSyntax : boolean = False) : integer;
<br>
Создает список найденные в рег.выражении ARegExpr подвыражений
<br>
Каждому подвыражению соответствует элемент в ASubExps, где
<br>
  String - исходный текст подвыражения (без обрамляющих '()')
<br>
  мл.слово Object - начальная позиция подвыражения в  ARegExpr, включая обрамляющий '(' если он есть!
<br>
  ст.слово Object - длина подвыражения, включая '(' и ')' если они есть!
<br>
AExtendedSyntax - должен быть True если модификатор /x будет включен при использовании данного регулярного выражения.
<br>
Эта функция полезна для написания визуальных редакторов рег.выражений и т.п. Пример использования есть в <a href=regexpstudio.html>TestRExp.dpr</a>
<br>

<br>
<b>Результат</b>&nbsp;&nbsp;&nbsp;<b>Комментарий</b>
<br>
</span><span style="font-family:Arial; font-size:1pt; color:#000000"><hr></span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>
<b>0</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Успех. Все скобки сбалансированы;
<br>
<b>-1</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Не хватает как минимум одной закрывающей скобки ')';
<br>
<b>-(n+1)</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В позиции n обнаружен незакрытый '[';
<br>
<b>n</b> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В позиции n обнаружена закрывающая ')' для которой нет открывающей '('.
<br>

<br>
Возвращает 0 если все скобки сбалансированы, или -1 если недостаточно закрывающих скобок ')', или n если в позиции n встречена закрывающая скобка ')' которой не соответствует ни одна открывающая '('.
<br>
Естественно, если Result &lt;&gt; 0, то ASubExprs может быть некорректен.
<br>

<br>

<br>
<span style="font-family:Arial; font-size:10pt; color:#0000FF"><b>Тип генерируемого при ошибках Exception</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>

<br>
Обработчик ошибок TRegExpr по умолчанию (Вы вполне можете его перекрыть и изменить его поведение) генерирует exception:
<br>

<br>
<b>ERegExpr</b> = class (Exception)
<br>
   public
<br>
    ErrorCode : integer; // Код ошибки. Ошибки компиляции выражения меньше 1000, что позволяет их отличить от ошибок выполнения выражения.
<br>
    CompilerErrorPos : integer; // Позиция в выражении где произошла последняя ошибка компиляции выражения
<br>
  end;
<br>

<br>

<br>
<span style="font-family:Arial; font-size:10pt; color:#0000FF"><b><a name="unicode_support"></a>Как использовать Unicode</b></span></span></span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>

<br>
TRegExpr теперь поддерживает работу с UniCode.
<br>

<br>
Обратите внимание, что этот режим практически неоптимизирован и работает <b>чрезвычайно медленно</b> (по сравнению со стандартным режимом).
<br>
Используйте его только если Вам действительно не обойтись без UniCode (а лучше примите участие в разработке TRegExpr и оптимизируйте UniCode-режим).
<br>

<br>
Чтобы переключить TRegExpr на работу с unicode уберите '.' из {.$DEFINE UniCode} в файле regexpr.pas.
<br>
Все строки после этого будут восприниматься как WideString.
<br>

<br>
</span></span></span>

  </TD>
  <TD vAlign=top align=left bgColor="white" height="100%"
       width=10>
  </TD>
</TR>
</TABLE><BR><BR>

<TABLE height=1 cellSpacing=0 cellPadding=0 width=780 bgColor=#0054a6 
       border=0>
<TR>
  <TD><IMG height=1 alt="" src="../../../imgs/0.gif" width=1 border=0></TD>
</TR>
</TABLE>

<TABLE height=70 cellSpacing=2 cellPadding=0 width=779 bgColor="white"
       border=0>
<TR>
  <TD align=right width=2><IMG src="../../../imgs/0.gif" width=2 height=1 border=0></TD>
  <TD vAlign=top align=left width="100%"><P class=pageauthor><I>&copy;&nbsp;<A 
      class=pageauthor href="http://RegExpStudio.com/">2004 Andrey V. Sorokin</A></I>,
      Saint Petersburg, Russia
      <BR><A class=pageauthor href="mailto:anso@mail.ru">anso@mail.ru</A>
      <BR><A class=pageauthor href="http://RegExpStudio.com/">RegExpStudio.com</A></P></TD>
  <TD vAlign=top align=right width=468><A href="http://www.helpandmanual.com"
      target="_blank"><img src="../../../TRegExpr/Help/hmad468x60.gif" width="468" height="60"
      border="0" alt="Help&Manual - the best help authoring tool!"></A></TD>
  <TD align=right width=4><IMG src="../../../imgs/0.gif" width=4 height=1 border=0></TD>
</TR>
</TABLE><BR>

</body>
</html>
