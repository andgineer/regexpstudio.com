<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<HTML xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<HEAD>
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=iso-8859-1">
  <meta name="Content-Language" content="english">
  <TITLE>MrDecorator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Regular Expressions,perl,regexp,Delphi,Pascal,FreePascal,Kylix,Libraries,VCL,CLX,Tools,files utils</TITLE>
  <!--  TRegExpr regular expressions (r.e. RegExpr regexp tregexpr), egrep perl unix; delphi pascal FreePascal Kylix freeware component Andrey Sorokin -->
  <meta name="home_url" content="http://RegExpStudio.com/">
  <meta name="GENERATOR" content="Help & Manual">
  <LINK REL="stylesheet" HREF="../../styles/default.css" TYPE="text/css">
  <meta name="description" content=" delphi pascal FreePascal Kylix freeware components: regular expressions (r.e. RegExpr regexp tregexpr), egrep perl unix; Andrey Sorokin">
  <meta name="abstract" content=" TRegExpr regular expressions (r.e. RegExpr regexp tregexpr), egrep perl unix; Andrey Sorokin">
  <meta name="keywords" content=" TRegExpr regular expressions (r.e. RegExpr regexp tregexpr), egrep perl unix; delphi pascal FreePascal Kylix freeware component Andrey Sorokin">
  <META NAME="distribution" CONTENT="world">
  <meta name="audience" content="all">
  <meta name="robots" content="index,all">
  <meta name="revisit" content="30 days">
  <meta name="revisit-after" content="30 days">
  <meta name="site-created" content="01-01-2004">
  <META NAME="author" CONTENT="RegExpStudio.com, Andrey V. Sorokin, Saint Petersburg, Russia.">
  <META NAME="copyright" CONTENT="Copyright &copy; RegExpStudio.com, Andrey V. Sorokin, Saint Petersburg, Russia. All rights reserved">
</HEAD>
  
<BODY bgcolor=#FFFFFF leftmargin="0" topmargin="0" marginwidth="0" 
      marginheight="0">

<TABLE bgColor=#0054a6 cellspacing="2" cellpadding="2" border="0" 
       width="780">
<TR>
  <TD align="left"><div class="MainTitle"><a href="http://RegExpStudio.com"
   title="" class="MainTitle"><span class="MainTitle">RegExp Studio</span></a>
<br>TRegExpr v.0.952 - Delphi Regular Expressions
<br><img src="../../imgs/0.gif" width="1" height="15" alt=""><br>
</div></TD>
  <TD align="right"><A class=LangSwitch
   href="../../../BG/TRegExpr/Help/About.html">Bulgarian</A><BR>
  <DIV class=LangSwitch>English<BR></DIV>
  <A class=LangSwitch
   href="../../../FR/TRegExpr/Help/About.html">French</A><BR>
  <A class=LangSwitch
   href="../../../DE/TRegExpr/Help/About.html">German</A><BR>
  <A class=LangSwitch
   href="../../../RU/TRegExpr/Help/About.html">Russian</A><BR>
  <A class=LangSwitch
   href="../../../ES/TRegExpr/Help/About.html">Spanish</A></TD>
</TR>
</TABLE>

<TABLE height=1 cellSpacing=0 cellPadding=0 width=780 bgColor="white" border=0>
<TR><TD><IMG height=1 alt="" src="../../imgs/0.gif" width=1 border=0></TD></TR>
</TABLE>


<TABLE width="780" height=24 cellspacing="2" cellpadding="2" border="0"
  bgColor=#0054a6>
<TR>
  <TD><img src="../../imgs/HomeSmall.gif" alt="About TRegExpr" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="About.html">About</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/WhatsNewSmall.gif" alt="What's new" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="Whats_new.html">What's&nbsp;new</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/DownloadsSmall.gif" alt="Installation" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="Installation.html">Installation</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/RegExpSyntaxSmall.gif" alt="Regular Expressions Syntax" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="RegExp_Syntax.html">Syntax</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/TRegExprInterfaceSmall.gif" alt="What's new" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="TRegExpr_Interface.html">Interface</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/FAQSmall.gif" alt="What's new" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="FAQ.html">FAQ</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><img src="../../imgs/DemosSmall.gif" alt="TRegExpr usage demos" height=16 width=16 border=0></TD>
  <TD><A class=top_menu href="Demos.html">Demos</A></TD>

  <TD width=5><IMG height=1 alt="" src="../../imgs/0.gif" width=5 border=0></TD>
  <TD><IMG src="../../imgs/AnSoHomePageSmall.gif" alt="AnSo@Web" height=16 width=18 border=0></TD>
  <TD><A class=top_menu href="Author.html">Author</A></TD>

  <TD width="100%">&nbsp;</TD>
</TR>
</TABLE>



<TABLE cellSpacing=14 cellPadding=0 width=779 bgColor="white" border=0>
<TR>
  <TD vAlign=top width=769 height="100%">


<span style="font-family:Arial; font-size:12pt; color:#000000"><span style="font-family:Arial; font-size:12pt; color:#0000FF"><b>MrDecorator</b></span><span style="font-family:Arial; font-size:12pt; color:#000000"><span style="font-family:Arial; font-size:12pt; color:#0000FF"><b>
<br>
</b></span></span></span></span></span></span>


<span style="font-family:Arial; font-size:10pt; color:#000000">Here we will discuss how to "decorate url's". 
<br>
I mean, what if You want to show some plain-text on the HTML-page. The mostly common example - web-forum (BBS board). The user enters the message, for example "the answer You can find at www.RegExpStudio.com" and it must be shown on web-page as text with HTML-link, i.e. converted to "the answer You can find at www.RegExpStudio.com"
<br>

<br>
There are two ways. 
<br>

<br>
The traditional one - You must make full featured text parser. This is an awful amount of tedious work ! For example, try to implement rules for URL search ;) 
<br>

<br>
The second - look at the text from bird's eye view with help of regular expressions engine. Your application will be implemented very fast and will be robust and easy to support ! 
<br>

<br>
Unfortunately, Delphi component palette contains no TRegularExpression component. But there are some third-party implementations (I think You already know at least one 8-)).. 
<br>

<br>
The complete source code, ready to run, available in TRegExpr Demos (<a href=hyperlinksdecorator.html>HyperLinksDecorator unit</a>)
<br>

<br>
<span style="font-family:Courier New; font-size:8pt; color:#000000"><b>uses</b>&nbsp;
<br>
RegExpr;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;Do&nbsp;not&nbsp;forget&nbsp;this&nbsp;line.&nbsp;Actually&nbsp;this&nbsp;is&nbsp;how&nbsp;TRegExpr&nbsp;'Install'&nbsp;-&nbsp;the&nbsp;</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;only&nbsp;thing&nbsp;You&nbsp;must&nbsp;do&nbsp;-&nbsp;include&nbsp;RegExpr&nbsp;into&nbsp;uses&nbsp;section.</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>

<br>
<b>type</b>&nbsp;
<br>
TDecorateURLsFlags&nbsp;=&nbsp;(
<br>
&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;describes,&nbsp;which&nbsp;parts&nbsp;of&nbsp;hyper-link&nbsp;must&nbsp;be&nbsp;included</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;into&nbsp;VISIBLE&nbsp;part&nbsp;of&nbsp;the&nbsp;link:</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;durlProto,&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;Protocol&nbsp;(like&nbsp;'ftp://'&nbsp;or&nbsp;'http://')</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;durlAddr,&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;TCP&nbsp;address&nbsp;or&nbsp;domain&nbsp;name&nbsp;(like&nbsp;'anso.da.ru')</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;durlPort,&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;Port&nbsp;number&nbsp;if&nbsp;specified&nbsp;(like&nbsp;':8080')</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;durlPath,&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;Path&nbsp;to&nbsp;document&nbsp;(like&nbsp;'index.htm')</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;durlBMark,&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;Book&nbsp;mark&nbsp;(like&nbsp;'#mark')</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;durlParam&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;URL&nbsp;params&nbsp;(like&nbsp;'?ID=2&amp;User=13')</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;);
<br>

<br>
TDecorateURLsFlagSet&nbsp;=&nbsp;<b>set</b>&nbsp;<b>of</b>&nbsp;TDecorateURLsFlags;
<br>

<br>
<b>function</b>&nbsp;DecorateURLs&nbsp;(
<br>
&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;can&nbsp;find&nbsp;hyper&nbsp;links&nbsp;like&nbsp;'http://...'&nbsp;or&nbsp;'ftp://..'</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;as&nbsp;well&nbsp;as&nbsp;links&nbsp;without&nbsp;protocol,&nbsp;but&nbsp;start&nbsp;with&nbsp;'www.'</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>

<br>
&nbsp;<b>const</b>&nbsp;AText&nbsp;:&nbsp;<b>string</b>;
<br>
&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;Input&nbsp;text&nbsp;to&nbsp;find&nbsp;hyper-links</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>

<br>
&nbsp;&nbsp;AFlags&nbsp;:&nbsp;TDecorateURLsFlagSet&nbsp;=&nbsp;[durlAddr,&nbsp;durlPath]
<br>
&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;Which&nbsp;part&nbsp;of&nbsp;hyper-links&nbsp;found&nbsp;must&nbsp;be&nbsp;included&nbsp;into&nbsp;visible</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;part&nbsp;of&nbsp;URL,&nbsp;for&nbsp;example&nbsp;if&nbsp;[durlAddr]&nbsp;then&nbsp;hyper&nbsp;link</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;'http://anso.da.ru/index.htm'&nbsp;will&nbsp;be&nbsp;decorated&nbsp;as</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;'&lt;a&nbsp;href="http://anso.da.ru/index.htm"&gt;anso.da.ru&lt;/a&gt;'</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>

<br>
&nbsp;&nbsp;)&nbsp;:&nbsp;<b>string</b>;
<br>
&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;Returns&nbsp;input&nbsp;text&nbsp;with&nbsp;decorated&nbsp;hyper&nbsp;links</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>

<br>
<b>const</b>&nbsp;
<br>
&nbsp;&nbsp;URLTemplate&nbsp;=&nbsp;
<br>
&nbsp;&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'(?i)'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">&nbsp;
<br>
&nbsp;&nbsp;&nbsp;+&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'('</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">&nbsp;
<br>
&nbsp;&nbsp;&nbsp;+&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'(FTP|HTTP)://'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;Protocol&nbsp;</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;&nbsp;+&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'|www\.)'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;trick&nbsp;to&nbsp;catch&nbsp;links&nbsp;without</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;protocol&nbsp;-&nbsp;by&nbsp;detecting&nbsp;of&nbsp;starting&nbsp;'www.'</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;&nbsp;+&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'([\w\d\-]+(\.[\w\d\-]+)+)'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;TCP&nbsp;addr&nbsp;or&nbsp;domain&nbsp;name</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;&nbsp;+&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'(:\d\d?\d?\d?\d?)?'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;port&nbsp;number</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;&nbsp;+&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'(((/[%+\w\d\-\\\.]*)+)*)'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;unix&nbsp;path</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;&nbsp;+&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'(\?[^\s=&amp;]+=[^\s=&amp;]+(&amp;[^\s=&amp;]+=[^\s=&amp;]+)*)?'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;request&nbsp;(GET)&nbsp;params</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;&nbsp;+&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'(#[\w\d\-%+]+)?'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;bookmark</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
<b>var</b>
<br>
&nbsp;&nbsp;PrevPos&nbsp;:&nbsp;integer;
<br>
&nbsp;&nbsp;s,&nbsp;Proto,&nbsp;Addr,&nbsp;HRef&nbsp;:&nbsp;<b>string</b>;
<br>
<b>begin</b>
<br>
&nbsp;&nbsp;Result&nbsp;:=&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">''</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">;&nbsp;
<br>
&nbsp;&nbsp;PrevPos&nbsp;:=&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">1</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">;&nbsp;
<br>
&nbsp;&nbsp;<b>with</b>&nbsp;TRegExpr.Create&nbsp;<b>do</b>&nbsp;<b>try</b>&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expression&nbsp;:=&nbsp;URLTemplate;&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b>&nbsp;Exec&nbsp;(AText)&nbsp;<b>then</b>&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>REPEAT</b>&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">''</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">;&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b>&nbsp;AnsiCompareText&nbsp;(Match&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">1</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">],&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'www.'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">)&nbsp;=&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">0</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">&nbsp;<b>then</b>&nbsp;<b>begin</b>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proto&nbsp;:=&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'http://'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Addr&nbsp;:=&nbsp;Match&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">1</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">]&nbsp;+&nbsp;Match&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">3</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">];
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HRef&nbsp;:=&nbsp;Proto&nbsp;+&nbsp;Match&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">0</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">];
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>else</b>&nbsp;<b>begin</b>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Proto&nbsp;:=&nbsp;Match&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">1</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">];
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Addr&nbsp;:=&nbsp;Match&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">3</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">];
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HRef&nbsp;:=&nbsp;Match&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">0</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">];
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>end</b>;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b>&nbsp;durlProto&nbsp;<b>in</b>&nbsp;AFlags
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>then</b>&nbsp;s&nbsp;:=&nbsp;s&nbsp;+&nbsp;Proto;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b>&nbsp;durlAddr&nbsp;<b>in</b>&nbsp;AFlags
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>then</b>&nbsp;s&nbsp;:=&nbsp;s&nbsp;+&nbsp;Addr;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b>&nbsp;durlPort&nbsp;<b>in</b>&nbsp;AFlags
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>then</b>&nbsp;s&nbsp;:=&nbsp;s&nbsp;+&nbsp;Match&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">5</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">];
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b>&nbsp;durlPath&nbsp;<b>in</b>&nbsp;AFlags
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>then</b>&nbsp;s&nbsp;:=&nbsp;s&nbsp;+&nbsp;Match&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">6</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">];
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b>&nbsp;durlParam&nbsp;<b>in</b>&nbsp;AFlags
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>then</b>&nbsp;s&nbsp;:=&nbsp;s&nbsp;+&nbsp;Match&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">9</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">];
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>if</b>&nbsp;durlBMark&nbsp;<b>in</b>&nbsp;AFlags
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>then</b>&nbsp;s&nbsp;:=&nbsp;s&nbsp;+&nbsp;Match&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">11</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">];
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result&nbsp;:=&nbsp;Result&nbsp;+&nbsp;System.Copy&nbsp;(AText,&nbsp;PrevPos,
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MatchPos&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">0</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">]&nbsp;-&nbsp;PrevPos)&nbsp;+&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'&lt;a&nbsp;href="'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">&nbsp;+&nbsp;HRef&nbsp;+&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'"&gt;'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">&nbsp;+&nbsp;s&nbsp;+&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080">'&lt;/a&gt;'</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PrevPos&nbsp;:=&nbsp;MatchPos&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">0</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">]&nbsp;+&nbsp;MatchLen&nbsp;[<span style="font-family:Courier New; font-size:8pt; color:#000080">0</span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">];
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>UNTIL</b>&nbsp;<b>not</b>&nbsp;ExecNext;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result&nbsp;:=&nbsp;Result&nbsp;+&nbsp;System.Copy&nbsp;(AText,&nbsp;PrevPos,&nbsp;MaxInt);&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>//&nbsp;Tail</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<b>finally</b>&nbsp;Free;
<br>
&nbsp;&nbsp;&nbsp;<b>end</b>;
<br>
<b>end</b>;&nbsp;<span style="font-family:Courier New; font-size:8pt; color:#000080"><i>{&nbsp;of&nbsp;function&nbsp;DecorateURLs
<br>
--------------------------------------------------------------}</i></span></span></span><span style="font-family:Courier New; font-size:8pt; color:#000000">
<br>
</span><span style="font-family:Arial; font-size:10pt; color:#000000">
<br>
Note, that You can easely extract any part of URL (see AFlags parameter). 
<br>

<br>

<br>
Conclusion 
<br>

<br>
"Free Your mind" ((c) The Matrix ;)) and You'll find many other tasks there regular expressions can save You incredible part of stupid coding work ! 
<br>

<br>
P.S. Sorry for terrible english. My native language is Pascal ;)
<br>

<br>
</span></span></span>

  </TD>
  <TD vAlign=top align=left bgColor="white" height="100%"
       width=10>
  </TD>
</TR>
</TABLE><BR><BR>

<TABLE height=1 cellSpacing=0 cellPadding=0 width=780 bgColor=#0054a6 
       border=0>
<TR>
  <TD><IMG height=1 alt="" src="../../imgs/0.gif" width=1 border=0></TD>
</TR>
</TABLE>

<TABLE height=70 cellSpacing=2 cellPadding=0 width=779 bgColor="white"
       border=0>
<TR>
  <TD align=right width=2><IMG src="../../imgs/0.gif" width=2 height=1 border=0></TD>
  <TD vAlign=top align=left width="100%"><P class=pageauthor><I>&copy;&nbsp;<A 
      class=pageauthor href="http://RegExpStudio.com/">2004 Andrey V. Sorokin</A></I>,
      Saint Petersburg, Russia
      <BR><A class=pageauthor href="mailto:anso@mail.ru">anso@mail.ru</A>
      <BR><A class=pageauthor href="http://RegExpStudio.com/">RegExpStudio.com</A></P></TD>
  <TD vAlign=top align=right width=468><A href="http://www.helpandmanual.com"
      target="_blank"><img src="hmad468x60.gif"" width="468" height="60"
      border="0" alt="Help&Manual - the best help authoring tool!"></A></TD>
  <TD align=right width=4><IMG src="../imgs/0.gif" width=4 height=1 border=0></TD>
</TR>
</TABLE><BR>

</body>
</html>
