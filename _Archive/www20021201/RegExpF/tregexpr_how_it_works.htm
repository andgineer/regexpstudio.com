<html><head><meta name="generator" content="Help & Manual 2.6.3"><title>Comment �a Fonctionne</title></head>
<body background="niceblue.gif" bgcolor="#FFFFFF">
<small><table width="100%"><tr><td align="right"><a href="tregexpr_installation.htm"><img src="1arrow4.gif" border="0"></a><a href="tregexpr_syntax.htm"><img src="1arrow5.gif" border="0"></a></td></tr></small><table width="100%" border="0" cellspacing="0" cellpadding="3" bgcolor="#ABFCFE"><tr><td align="left">
<font face="Arial" size="3" color="#000000"><font face="Arial" size="3" color="#0000FF"><b>Comment �a Fonctionne</b></font><font face="Arial" size="4" color="#000000"><font face="Arial" size="4" color="#0000FF"><b>
<br>
</b></font></font></font>

</td></tr></table><br>

<font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">
<br>
</font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#0000FF"><b>Simple illustrations</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">
<br>

<br>
Si vous n</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">�tes pas familier avec les expressions r�guli�res, svp, aller au sujet <a href="tregexpr_syntax.htm">syntaxe</a>.
<br>

<br>

<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100"><b>Utiliser les routines globales</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">
<br>
 C</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">est simple mais pas une fa�on flexible et pratique.
<br>

<br>
<table border="0" cellpadding="0" cellspacing="0"><tr valign="TOP"><td width="12"></td><td><font face="Arial" size="2" color="#010100"></font></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>ExecRegExpr ('3-(2-2|4)', 'T�l�phone: 555-1234')</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">;
&nbsp;<br>
</font></font></td></tr><tr valign="top"><td></td><td><font face="Arial" size="2" color="#010100"></font></td></tr></table><font face="Arial" size="2" color="#010100"></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">   retourne Vrai
<br>
<table border="0" cellpadding="0" cellspacing="0"><tr valign="TOP"><td width="12"></td><td><font face="Arial" size="2" color="#010100"></font></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>ExecRegExpr ('^3-(2-2|4)', 'T�l�phone: 555-1234')</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">;
&nbsp;<br>
</font></font></td></tr><tr valign="top"><td></td><td><font face="Arial" size="2" color="#010100"></font></td></tr></table><font face="Arial" size="2" color="#010100"></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">   retourne Faux, parce qu</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">il y a des symboles avant le num�ro de t�l�phone on utilise le m�tasymbole '^' (qui signifie d�but de ligne).
<br>
<table border="0" cellpadding="0" cellspacing="0"><tr valign="TOP"><td width="12"></td><td><font face="Arial" size="2" color="#010100"></font></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>ReplaceRegExpr ('au produit', 'Tendez un regard au produit. TRegExpr est le meilleur!', '� TRegExpr');</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">
&nbsp;<br>
</font></font></td></tr><tr valign="top"><td></td><td><font face="Arial" size="2" color="#010100"></font></td></tr></table><font face="Arial" size="2" color="#010100"></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">   retourne 'Tendez un regard � TRegExpr. TRegExpr est le meilleur !'.
<br>

<br>

<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100"><b>Utiliser la classe TRegExpr
<br>
</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100"> Vous avez tout le pouvoir de la librairie.
<br>

<br>
// Cette simple fonction extrait tous les e-mail de la cha�ne d</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">entr�e.
<br>
// et place la liste de tous les e-mail dans la cha�ne sortante.
<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>function ExtractEmails (const AInputString : string) : string;
<br>
const
<br>
</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EmailRE = '[_a-zA-Z.]+@[_a-zA-Z]+(.[_a-zA-Z]+)+'
<br>
var
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r : TRegExpr;
<br>
begin
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result := '';
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r := TRegExpr.Create;</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100"> // Cr�e L</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">objet</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100"> // s</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">assure de la rel�che de m�moire en cas d</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">erreurs d'exceptions.</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.Expression := EmailRE;
<br>
</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Assigne le code source � l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">e.r. Il sera compil� quand ce sera n�cessaire
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// (par exemple quand Exec sera appel�). S</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">il y a des erreurs dans l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">e.r.
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Des exceptions seront lev�es durant la compilation de l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">e.r.
<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if r.Exec (AInputString) then
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REPEAT
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result := Result + r.Match [0] + ', ';
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNTIL not r.ExecNext;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;finally r.Free;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;
<br>
end;
<br>
begin
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExctractEmails ('My e-mails is anso@mail.ru and anso@usa.net');
<br>
</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// retourne 'anso@mail.ru, anso@usa.net, '
<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>end.
<br>
</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">// Noter: La compilation de l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">e.r. durant l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">attribution de l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">expression
<br>
// prend quelque temps , si vous voulez utiliser cette fonction plusieurs fois
<br>
// ce sera du travail inutile...
<br>
// Pour l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">optimiser de fa�on significative, cr�er TRegExpr
<br>
// et pr�compiler l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">expression durant la phase d</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">initialisation du programme.
<br>

<br>

<br>
// Ce simple exemple extrait les num�ros de t�l�phone et
<br>
// l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">analyse en partie (code r�gional, ville, num�ro interne).
<br>
// Ensuite il substitut les parties en gabarit.
<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>function ParsePhone (const AInputString, ATemplate : string) : string;</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>
<br>
</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>const
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntPhoneRE = '(+*)?((+) *)?+(-*)*';</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>
<br>
</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>var
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r : TRegExpr;
<br>
begin
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r := TRegExpr.Create;</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100"> // Cr�e l'objet</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100"> // s</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">assure de la rel�che de m�moire en cas d</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">erreurs d'exceptions.</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.Expression := IntPhoneRE;
<br>
</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Assigne le code source � l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">e.r. Il sera compil� quand n�cessaire
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// (par exemple quand Exec sera appel�). S</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">il y a des erreurs dans l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">e.r.
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Des exceptions seront lev�es durant la compilation de l</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">e.r.
<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>if r.Exec (AInputString)
<br>
</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>then Result := r.Substitute (ATemplate)
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else Result := '';
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;finally r.Free;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;
<br>
end;
<br>
begin
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ParsePhone ('Phone of AlkorSoft (project PayCash) is +7(812) 329-44-69',
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Zone code $1, city code $2. Whole phone number is $&amp;.');
<br>
</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// retourne 'Code R�gional +7, Code de Ville (812) . T�l�phone complet +7(812) 329-44-69.'
<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#800000"><b>end.
<br>

<br>

<br>
</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">
<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#0000FF"><b>Ilustrations plus complexes</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">
<br>

<br>
Vous pouvez trouver des illustrations plus complexes pour utiliser TRegExpr dans le projet <a href="tregexpr_testrexp.htm">TestRExp.dpr</a>  et <a href="tregexpr_decorator.htm">HyperLinkDecorator.pas</a>.
<br>
Voir aussi mon petit article � <a href="http://www.delphi3000.com/member.asp?ID=1300',`',1)" TARGET="_top">Delphi3000.com</A> (en Anglais) et <a href="http://delphi.vitpc.com/mastering/strings_birds_eye_view.htm',`',1)" TARGET="_top">Delphi Kingdom</A> (en Russe).</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">
<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">
<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">
<br>
</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#0000FF"><b>Explication plus d�taill�e</b></font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">
<br>

<br>
Svp, voir la <a href="tregexpr_interface.htm">description</a> d</font></font><font face="Times New Roman" size="2" color="#000000"><font face="Times New Roman" size="2" color="#010100">'</font></font><font face="Arial" size="2" color="#000000"><font face="Arial" size="2" color="#010100">interface de TregExpr.
<br>

<br>
</font></font></font>

<small><table width="100%"><tr><td align="right"><a href="tregexpr_installation.htm"><img src="1arrow4.gif" border="0"></a><a href="tregexpr_syntax.htm"><img src="1arrow5.gif" border="0"></a></td></tr></small>

<script>     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){                 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),             m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)     })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');      ga('create', 'UA-90368520-1', 'auto');     ga('send', 'pageview');  </script>

</body></html>
