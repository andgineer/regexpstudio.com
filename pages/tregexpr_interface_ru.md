---
layout: page
title: TRegExr interface
lang: ru
ref: interface
permalink: /tregexp_interface_ru/
---

Пример использования библиотеки можно посмотреть в TestRExp.dpr (если Вы используете Delphi 3 или Delphi 2 то при компиляции Вы получите ряд сообщений о неизвестных свойствах форм. Вы можете проигнорировать это - соответствующие свойства используются для динамического выравнивания компонентов на формах и программа вполне работоспособна и без них - просто при изменении размеров форм не будут изменяться размеры и положение компонентов).

Работа с регулярными выражениями инкапсулирована в объект TRegExpr (реализация - в файле RegExpr.pas) обладающим следующими public- методами и свойствами:

property Expression : string
Этому свойству следует присвоить строку с описанием регулярного выражения, при этом оно будет автоматически откомпилировано во внутренний псевдо-код (для ускорения работы). Обратите внимание, что при этом может произойти исключительная ситуация (exception) в случае, если в регулярном выражении есть ошибки.

property ExtSyntaxEnabled : boolean
Позволяет отключить внесенные автором TRegExpr расширения синтаксиса регулярных выражений (по умолчанию они включены)

function Exec (const InputString : string; Offset: integer = 1) : boolean;
Выполняет проверку строки InputString по шаблону из регулярного выражения Expression начиная с позиции Offset (по умолчанию с позиции 1 - первый символ строки).
В случае успеха функция возвращает true, при этом в свойствах MatchPos [0] и MatchLen [0] сохраняется номер первого символа найденной подстроки и ее длина.

function Substitute (const ATemplate : string) : string;
Возвращает результат подстановки в шаблон ATemplate найденного в Exec регулярного выражения. В шаблоне можно использовать спец.-символ '&' для подстановки всего выражения и спец символы '\n' для подстановки подвыражений (n-номер подвыражения, от 1 до 9, подвыражение - это часть регулярного выражения заключенная в круглые скобки). Если Вам необходимо вставить в шаблон символы '&' и '\' как обычные, а не спец-символы, используйте '\&' и '\\' соответственно. Большое количество примеров, иллюстрирующих использование Substitute Вы найдете в TestRExp.dpr.

procedure Split (AInputStr : string; APieces : TStrings);
Разделяет строку AInputStr на подстроки по вхождениям r.e. (результат - в APieces)

function Replace (AInputStr : string; const AReplaceStr : string)
Возвращает строку AInputStr в которой все вхождения r.e. заменены на AReplaceStr

property MatchCount : integer
Число описанных в шаблоне подвыражений (выделенных круглыми скобками), обнаруженных в протестированной в Exec строке. Первым подвыражением (с индексом ноль) считается все регулярное выражение в целом, поэтому, при успешном выполнении Exec, MatchCount всегда больше нуля.

property MatchPos [Idx : integer] : integer
Начальные позиции подвыражений, обнаруженных в протестированной в Exec строке.

property MatchLen [Idx : integer] : integer
Длины вхождений подвыражений, обнаруженных в протестированной в Exec строке.

property MatchLen [Idx : integer] : string
Эквивалентно Copy (InputString, MatchPos [Idx], MatchLen [Idx])

Кроме того, в библиотеку regexpr.pas включен ряд полезных функций, упрощающих работу с регулярными выражениями (в основном, они просто позволяют не создавать явно объект TRegExpr). Более подробно - см.исходные тексты библиотеки.



